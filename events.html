<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="events.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ´»å‹•è³‡è¨Š - é³³å±±é«˜ä¸­å­¸ç”Ÿæœƒ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo-container">
            <h1 id="é³³å±±é«˜ä¸­å­¸ç”Ÿæœƒ" class="logo">é³³å±±é«˜ä¸­å­¸ç”Ÿæœƒ</h1>
            <span class="theme-toggle">ğŸŒ“</span>
            </div>
            <button class="menu-toggle" aria-label="Toggle menu">â˜°</button>
            <nav class="main-nav">
            <ul class="nav-list">
                <li><a href="index.html">é¦–é </a></li>
                <li><a href="about.html" ">é—œæ–¼æˆ‘å€‘</a></li>
                <li><a href="departments.html">éƒ¨é–€ä»‹ç´¹</a></li>
                <li><a href="events.html"class="active">æ´»å‹•è³‡è¨Š</a></li>
                <li><a href="documents.html">å…¬é–‹æ–‡ä»¶</a></li>
                <li><a href="contact.html">è¯çµ¡æˆ‘å€‘</a></li>
            </ul>
            </nav>
        </div>
        </header>

    <main class="main-content" role="main">
        <section class="section events-hero">
            <div class="container">
                <h1>æ´»å‹•è³‡è¨Š</h1>
                <p>åƒèˆ‡ç²¾å½©æ´»å‹•ï¼Œè±å¯Œä½ çš„æ ¡åœ’ç”Ÿæ´»</p>
            </div>
        </section>

        <div class="container">
            <div class="events-filter">
                <button class="filter-btn active" data-filter="all">å…¨éƒ¨æ´»å‹•</button>
                <button class="filter-btn" data-filter="upcoming">å³å°‡èˆ‰è¡Œ</button>
                <button class="filter-btn" data-filter="past">æ­·å²æ´»å‹•</button>
            </div>

            <div id="events-container" class="events-container">
                <!-- æ´»å‹•å¡ç‰‡å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </main>

    <div id="eventModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="eventDetails"></div>
        </div>
    </div>

    <footer class="footer">
            <div class="container">
                Â© 2024 é³³å±±é«˜ä¸­å­¸ç”Ÿæœƒ. ç‰ˆæ¬Šæ‰€æœ‰.
            </div>
        </footer>
    
        <div id="cuteElement" class="cute-element" aria-label="äº’å‹•å…ƒç´ ">
            ğŸ¾
        </div>
    
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const eventsContainer = document.getElementById('events-container');
                const modal = document.getElementById('eventModal');
                const modalContent = document.querySelector('.modal-content');
                const closeModal = document.querySelector('.close-modal');
                const eventDetails = document.getElementById('eventDetails');
                const themeToggle = document.querySelector('.theme-toggle');
                const body = document.body;
    
                // ä¸»é¡Œåˆ‡æ›åŠŸèƒ½
                function setTheme(theme) {
                    if (theme === 'dark') {
                        body.classList.remove('light-theme');
                        body.classList.add('dark-theme');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        body.classList.remove('dark-theme');
                        body.classList.add('light-theme');
                        localStorage.setItem('theme', 'light');
                    }
                }
    
                const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
                setTheme(savedTheme);
    
                themeToggle.addEventListener('click', () => {
                    const currentTheme = body.classList.contains('dark-theme') ? 'dark' : 'light';
                    setTheme(currentTheme === 'dark' ? 'light' : 'dark');
                });
    
                // å¾APIç²å–æ´»å‹•æ•¸æ“š
                async function fetchEvents() {
                    try {
                        const response = await fetch('https://fssa-event.vic0407lu.workers.dev/api/events');
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        const events = await response.json();
                        displayEvents(events);
                    } catch (error) {
                        console.error('ç²å–æ´»å‹•æ™‚å‡ºéŒ¯:', error);
                        eventsContainer.innerHTML = '<p class="error-message">ç„¡æ³•è¼‰å…¥æ´»å‹•è³‡è¨Šï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>';
                    }
                }
    
                // é¡¯ç¤ºæ´»å‹•å¡ç‰‡
                function displayEvents(events) {
                    eventsContainer.innerHTML = '';
                    const currentDate = new Date();
                    
                    events.forEach(event => {
                        const startDate = new Date(event.startDate);
                        const category = startDate > currentDate ? 'upcoming' : 'past';
                        
                        const eventCard = document.createElement('div');
                        eventCard.className = `event-card ${category}`;
                        eventCard.innerHTML = `
                            <div class="event-content">
                                <h2 class="event-title">${event.title}</h2>
                                <p>${event.summary}</p>
                                <p>${formatDate(startDate)}</p>
                                <button class="event-link" data-id="${event.id}">äº†è§£æ›´å¤š</button>
                            </div>
                        `;
                        eventsContainer.appendChild(eventCard);
                    });
    
                    // ç‚ºæ¯å€‹"äº†è§£æ›´å¤š"æŒ‰éˆ•æ·»åŠ é»æ“Šäº‹ä»¶
                    document.querySelectorAll('.event-link').forEach(button => {
                        button.addEventListener('click', () => openModal(events.find(e => e.id === parseInt(button.dataset.id))));
                    });
                }
    
                // æ‰“é–‹æ¨¡æ…‹æ¡†
                function openModal(event) {
                    eventDetails.innerHTML = `
                        <h2>${event.title}</h2>
                        <p><strong>æ—¥æœŸ:</strong> ${formatDate(new Date(event.startDate))} - ${formatDate(new Date(event.endDate))}</p>
                        <p>${event.description}</p>
                        ${event.images.length ? '<h3>åœ–ç‰‡</h3><div class="event-images">' + event.images.map(img => `<img src="${img}" alt="æ´»å‹•åœ–ç‰‡">`).join('') + '</div>' : ''}
                        ${event.attachments.length ? '<h3>é™„ä»¶</h3><ul>' + event.attachments.map(att => `<li><a href="${att.url}" target="_blank">${att.name}</a></li>`).join('') + '</ul>' : ''}
                        ${event.links.length ? '<h3>ç›¸é—œé€£çµ</h3><ul>' + event.links.map(link => `<li><a href="${link.url}" target="_blank">${link.name}</a></li>`).join('') + '</ul>' : ''}
                    `;
                    modal.classList.add('active');
                }
    
                // é—œé–‰æ¨¡æ…‹æ¡†
                closeModal.addEventListener('click', () => modal.classList.remove('active'));
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) modal.classList.remove('active');
                });
    
                // æ ¼å¼åŒ–æ—¥æœŸ
                function formatDate(date) {
                    return date.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' });
                }
    
                // éæ¿¾åŠŸèƒ½
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelector('.filter-btn.active').classList.remove('active');
                        btn.classList.add('active');
                        const filter = btn.dataset.filter;
                        document.querySelectorAll('.event-card').forEach(card => {
                            if (filter === 'all' || card.classList.contains(filter)) {
                                card.style.display = 'block';
                            } else {
                                card.style.display = 'none';
                            }
                        });
                    });
                });
                // ç§»å‹•ç«¯é¸å–®åˆ‡æ›
                const menuToggle = document.querySelector('.menu-toggle');
                const navList = document.querySelector('.nav-list');
                
                if (menuToggle && navList) {
                    menuToggle.addEventListener('click', () => {
                        navList.classList.toggle('active');
                        const isExpanded = navList.classList.contains('active');
                        menuToggle.setAttribute('aria-expanded', isExpanded);
                    });
                }
                // å¯æ„›å…ƒç´ é»æ“Šæ•ˆæœ
                const cuteElement = document.getElementById('cuteElement');
                const emojis = ['ğŸ¾', 'ğŸ“', 'ğŸ“š', 'ğŸ–‹ï¸', 'ğŸ'];
                let currentEmojiIndex = 0;
                cuteElement.addEventListener('click', () => {
                    currentEmojiIndex = (currentEmojiIndex + 1) % emojis.length;
                    cuteElement.textContent = emojis[currentEmojiIndex];
                    cuteElement.style.transform = 'scale(1.2) rotate(10deg)';
                    setTimeout(() => {
                        cuteElement.style.transform = 'scale(1) rotate(0deg)';
                    }, 300);
                });
    
                // ç²å–ä¸¦é¡¯ç¤ºæ´»å‹•
                fetchEvents();
            });
        </script>
    </body>
    </html>